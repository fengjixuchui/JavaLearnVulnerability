package CVE20202551;

import cn.hutool.core.util.HexUtil;
import org.python.parser.ast.Str;
import util.HexStringUtil;
import util.SocketUtil;

import java.util.regex.*;


import java.io.UnsupportedEncodingException;
import java.lang.reflect.Array;
import java.util.Arrays;

/**
 * @ClassName: test
 * @Description: TODO
 * @Author: Summer
 * @Date: 2020/8/4 17:23
 * @Version: v1.0.0
 * @Description:
 **/
public class test {
    static String Regex = "0042454108010300000000(.*?)6572766572";
    static String Regex2 = "0042454108010300000000(.*?)0044524d493a7765626c6f6769632e636c75737465722e73696e676c65746f6e2e436c75737465724d617374657252656d6f74653a30303030303030303030303030303030(.*?)2c00";
//    static String Regex = "0042454108010300000000(.){0,120}736572766572(.){1,50}2000";
    static String Input = "47494f5001020001000003a00000000200000000000000030000000f000000180000000100000000000000000000000101000000000000000000000600000144000000000000002849444c3a6f6d672e6f72672f53656e64696e67436f6e746578742f436f6465426173653a312e3000000000010000000000000108000102000000000931302e302e302e3400001b590000006c00424541080103000000000c41646d696e53657276657200000000000000002849444c3a6f6d672e6f72672f53656e64696e67436f6e746578742f436f6465426173653a312e30000000000331320000000000014245412c0000001000000000000000006f36cecc1a3878bb00000003000000010000002c00000000000100200000000300010020000100010501000100010100000000030001010000010109050100010000001900000037000000000000002f687474703a2f2f31302e302e302e343a373030312f6265615f776c735f696e7465726e616c2f636c61737365732f00000000002000000004000000014245410000000004000c01030000000e0000002d000000000000001d49444c3a6f6d672e6f72672f434f5242412f4f626a6563743a312e3000000000000000010000000000000044524d493a7765626c6f6769632e636c75737465722e73696e676c65746f6e2e436c75737465724d617374657252656d6f74653a3030303030303030303030303030303000000000010000000000000190000102000000000931302e302e302e3400001b590000008800424541080103000000000c41646d696e536572766572000000000000000044524d493a7765626c6f6769632e636c75737465722e73696e676c65746f6e2e436c75737465724d617374657252656d6f74653a30303030303030303030303030303030000000000433333100000000014245412c0000001000000000000000006f36cecc1a3878bb00000005000000010000002c00000000000100200000000300010020000100010501000100010100000000030001010000010109050100010000001900000037000000000000002f687474703a2f2f31302e302e302e343a373030312f6265615f776c735f696e7465726e616c2f636c61737365732f00000000001f000000040000000300000020000000040000000100000021000000580001000000000001000000000000002200000000004000000000000806066781020101010000001f0401000806066781020101010000000f7765626c6f67696344454641554c540000000000000000000000000000000000";
    static String r = "";

    public static void main(String[] args) {
        String list = "00424541080103000000000c41646d696e536572766572000000000000000044524d493a7765626c6f6769632e636c75737465722e73696e676c65746f6e2e436c75737465724d617374657252656d6f74653a30303030303030303030303030303030000000000433333100000000014245412c0000001000000000000000006f36cecc1a3878bb";
        Pattern pattern = Pattern.compile(Regex);
        Matcher matcher = pattern.matcher(Input);

        if (matcher.find()){
//            System.out.println(list);
            System.out.println("" + matcher.group(0));
            r = matcher.group(0);
            if (r.length() < 60){
                r = SocketUtil.addZeroForNum(r , 60);
            }
            System.out.println(r.length());


        }else{
            System.out.println("siii");
        }
        String Regex2 = r + "(.*?)002c00";
        System.out.println(Regex2);
        Pattern pattern1 = pattern.compile(Regex2);
        Matcher matcher1 = pattern1.matcher(Input);
        if (matcher1.find()){
            System.out.println(matcher1.group());
            System.out.println(matcher1.group().length());
            System.out.println(matcher1.groupCount());

        }
        if (matcher1.find()){
            r = matcher1.group().substring(0,272);
            System.out.println(r);
            System.out.println(list);
            System.out.println(r.length());
            System.out.println(matcher1.groupCount());
        }
        System.out.println(r.contains(list));
        System.out.println(list.length());



    }


}
